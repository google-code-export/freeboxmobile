#summary Documentation sur l'utilisation et la creation des skins (partie Telecommande)
#labels Phase-Implementation



<wiki:toc max_depth="2" />

= Introduction =

La partie télécommande est divisée en deux parties :<br>

- Onglet Mosaique<br>
- Onglet Telecommande<br>

Il est possible de créer des vues personnalisées pour ces deux vues. 

Vous trouverez dans cette page toutes les informations nécessaires à la création de votre propre skin.


= Format du skin =

Le skin doit être un fichier zip contenant :

- un fichier au format apk (application comportant le skin)<br>
- un fichier nommé info dont le contenu est uniquement le nom complet de la classe qui permettra de renvoyer la vue (exemple : com.skin.fichierSkin)<br>
- tout autres fichiers auxquels vous voudriez accéder<br>

Le fichier doit être placé sur la carte SD dans le repertoire :
- freeboxmobile/.skins/remote/ (pour un skin destiné à la partie Telecommande)<br>
- freeboxmobile/.skins/mosaic/ (pour un skin destiné à la partie Mosaique)<br>


= Squelette du skin Télécommande =

La classe doit respecter les règles suivantes :

- ne pas implémenter Activity<br>
- posséder un constructeur ayant pour unique paramètre un object Context<br>
- posséder une méthode void setPathView(String path)<br>
- posséder une méthode ViewGroup getViewGroup()<br>


= Squelette du skin Mosaique =

La classe doit respecter les règles suivantes :

- ne pas implémenter Activity<br>
- posséder un constructeur ayant pour unique paramètre un object Context<br>
- posséder une méthode <pre>void setPathView()</pre><br>
- posséder une méthode <pre>ViewGroup getViewGroup(String path)</pre><br>
- posséder une méthode <pre>void setMosaicInfo(HashMap<String, LinkedList<String>> infos)</pre><br>


= Explication des méthodes et des contraintes =

Il n'est pas possible d'accéder aux ressources du fichier apk externe. Il est néanmoins possible de mettre les fichiers que vous souhaitez dans le fichier apk. Ces fichiers seront accessibles dans le dossier ou sera copié le skin (voir methode setPathView).

Constructeur avec l'objet Context :
Cela vous permettra de faire appel à vos ressources externes ainsi qu'aux différentes ressources du téléphone.

<pre>void setPathView(String path)</pre>
Cette méthode est appelée par l'application pour vous fournir le chemin dans lequel est copié votre skin. Vous pourrez alors accéder à vos ressources par rapport à ce chemin

<pre>void setMosaicInfo(HashMap<String, LinkedList<String>> infos)</pre>
Pour vous donner la possibilité de faire la mosaique que vous souhaitez, nous vous mettons à disposition au démarrage de l'application des informations concernant les chaines de l'utilisateur. 

Les informations sont les suivantes (key : value) :
- imgs : emplacement des fichiers images des chaines<br>
- names : nom des chaines<br>
- channels : numéros des chaines<br>

<pre>ViewGroup getViewGroup()</pre>
Après vous avoir fourni toutes les informations, nous appelerons cette méthode de votre classe.
Vous devrez alors renvoyer votre layout (LinearLayout, Gallerie, TableWidget, ...). 
La seule contrainte est que, ne pouvant accéder aux ressources de votre application, vous ne pourrez donc pas accéder à un fichier layout. Vous devrez donc créer votre layout en Java.

= Communication avec la télécommande =

Pour que votre skin soit pleinement intégré à l'application, il faudra qu'il puisse envoyer ses ordres à la télécommandes. 

Pour cela, vous pourrez appelez la méthode sendBroadcast sur l'objet Context qui vous ai fourni.

Les actions qui sont interceptés sont les suivantes (respecter les majuscules et minuscules) :

- "REMOTECOMMAND" signifie que vous souhaitez envoyer une commande à la télécommande.<br>
Les paramètres disponibles sont les suivants :<br>
- "repeat" de type int : possibilité de répéter une commande plusieurs fois<br>
- "longClick" de type boolean : indique si vous souhaitez effectuer un long click<br>
- "cmd" de type String : la commande que vous souhaitez taper (exemple : power pour allumer/éteindre la freebox)<br>


- "REMOTECHANNEL" signifie que la commande que vous allez envoyer est un numéro de chaine.<br>
Les paramètres disponibles sont les suivants :<br>
- "channel" de type int : chaine sur laquelle vous souhaitez aller<br>		

	
- "REMOTECODE" signifie que la commande que vous allez envoyer est un code parental.<br>
Les paramètres disponibles sont les suivants :<br>
- "code" de type int : code parental à saisir<br>

= Actions disponibles =

Ceci est un rappel des actions disponibles (issu de UniversFreebox):
<pre> 
power : la touche rouge on/off 
list : la touche d’affichage de la liste des chaînes entre power et tv 
tv : la touche verte TV de commutation péritel. 
 
0 à 9 : les touches 0 à 9 
 
back : la touche jaune en dessous du 7 
swap : la touche en dessous du 9 
 
info, mail, help, pip : les touches bleues à droite des numéros de chaîne 
epg, media, options : les fonctionnalités "secondaires" de ces mêmes touches 
 
vol_inc, vol_dec : volume+ et volume- 
prgm_inc, prgm_dec : program+ et program- 
ok : touche OK 
up, right, down, left : les touches directionnelles entourant le OK 
 
mute : la touche de mise en sourdine 
home : la touche free 
rec : la touche d’enregistrement 
bwd : la touche de retour en arrière (<<) 
prev : la touche "précédent" (|<<) 
play : la touche lecture/pause 
fwd : la touche d’avance rapide (>>) 
next : la touche "suivant" (>>|) 
 
Concernant les boutons de couleurs, de haut en bas, et de gauche à droite (par rapport à la télécommande physique) les valeurs disponibles pour : 
 
red : le bouton rouge (B) 
green : le bouton vert (A) 
yellow : le bouton jaune (Y) 
blue : le bouton bleu (X) 
</pre> 

= Améliorations =
N'hésitez pas à nous faire part des évolutions que nous pourrions apporter à ces parties.